
-- 회원 정보
drop table MEMBER cascade constraints;

create table member(
    id varchar2(100) primary key, --아이디
    mtype varchar2(100) not null, --트레이너(trainer) or 일반 회원(generic) or 관리자(admin)
    name varchar2(100) not null, --이름
    password varchar2(100) not null, --비밀번호
    nickname varchar2(100) not null, --별명
    birth date, --생년월일
    mphone varchar2(100), --휴대전화
    email varchar2(100) not null, --이메일
    maddr1 varchar2(500), --주소1
    maddr2 varchar2(100), --주소2
    gender varchar2(10) not null check(gender in('남자','여자')) --성별
);

insert into member(id,mtype,name,password,nickname,birth,mphone,email,maddr1,maddr2,gender)
		values('hong','generic','홍길동','qwerty1!','홍시','1990-09-09','01090909090','hong@fitquest.com','서울 중구 북창동 136','1층','남자');
insert into member(id,mtype,name,password,nickname,birth,mphone,email,maddr1,maddr2,gender)
		values('kim','trainer','홍길동','1234','홍시','1991-09-09','01090909090','kim@fitquest.com','서울 중구 북창동 136','2층','여자');
insert into member(id,mtype,name,password,nickname,birth,mphone,email,maddr1,maddr2,gender)
		values('admin','admin','관리자','1234','관리자','1991-09-09','01090909090','admin@fitquest.com','서울 중구 북창동 136','2층','여자');

select * from MEMBER;
commit;

 
--헬스장
drop sequence gseq;
create sequence gseq
  increment by 1
  start with 1
  minvalue 1
  maxvalue 10000
  nocache;  
  
drop table gym cascade constraints;
CREATE TABLE gym (
   gnum   number   primary key, --헬스장 번호
   gname   varchar2(40)   NOT NULL, --헬스장명
   gaddr1   varchar2(500)   NOT NULL, --헬스장 주소1
   gaddr2   varchar2(60)   NOT NULL, --헬스장 주소2
   gphone   varchar2(60)   NOT NULL --헬스장 전화번호
);

insert into gym values(gseq.nextval,'헬스장1','경기 성남시 분당구 판교동 649','2층','0222223333');

select * from gym;
commit;

-- 트레이너 
drop table trainer cascade constraints;
CREATE TABLE trainer (
   ID varchar2(30) references MEMBER(ID) on delete cascade primary key, -- 회원아이디 
   gnum   number NOT NULL, --헬스장 번호
   activity   varchar2(30)   NOT NULL, --운동 카테고리
   purpose   varchar2(100)   NOT NULL, --운동 목적
   intro   varchar2(500)   NOT NULL, -- 소개 내용
   exp   varchar2(50)   NOT NULL, --경력
   timage   varchar2(50) --트레이너 사진
);

insert into trainer values('kim', 1, 'PT', '체중', 'hi~','개인 pt 30년', 'tr1.jpg');

select * from trainer;
commit;

drop sequence bseq;
create sequence bseq
  increment by 1
  start with 1
  minvalue 1
  maxvalue 10000
  nocache;  

-- 게시판
drop table BOARD cascade constraints;
create table board (
   Bnum number primary key,
   id varchar2(100) references MEMBER(ID) on delete cascade, -- 회원아이디 
   btype   varchar2(10)   NOT NULL check(btype in('자유','건강')),
   bcategory   varchar2(30)   NOT NULL, --카테고리 (자유-일반/운동인증, 건강 정보-운동/식단/기타)
   Bsubject   varchar2(100)   NOT NULL, --제목
   Bregdate   date  default sysdate, --작성일
   Breadcount   number DEFAULT 0, --조회수
   Bref   number, --같은 글 그룹
   Brestep   number, --글의 순서(오래된건 후순위)
   Brelevel   number, --몇번째 글(글, 답글,답답글)
   Bcontent   varchar2(4000)   NOT NULL, --내용
   Bimage   varchar2(300) --건강 정보 게시판의 이미지
);

insert into board(Bnum,id,btype,bcategory,Bsubject,Bref,Brestep,Brelevel,Bcontent)
values(bseq.nextval,'hong','자유','일반','테스트 글',1,0,0,'테스트 글 내용입니다.');

insert into board(Bnum,id,btype,bcategory,Bsubject,Bref,Brestep,Brelevel,Bcontent)
values(bseq.nextval,'hong','자유','일반','테스트 글',1,1,1,'테스트 글 내용입니다.');

insert into board(Bnum,id,btype,bcategory,Bsubject,Bref,Brestep,Brelevel,Bcontent)
values(bseq.nextval,'hong','자유','일반','테스트 글',1,2,2,'테스트 글 내용입니다.');

insert into board(Bnum,id,btype,bcategory,Bsubject,Bref,Brestep,Brelevel,Bcontent)
values(bseq.nextval,'hong','자유','일반','테스트 글',1,3,1,'테스트 글 내용입니다.');

insert into board(Bnum,id,btype,bcategory,Bsubject,Bref,Brestep,Brelevel,Bcontent)
values(bseq.nextval,'hong','자유','운동인증','운동인증 글',2,0,0,'운동인증 글 내용입니다.');


select * from BOARD;
commit;



drop sequence sseq;
create sequence sseq
  increment by 1
  start with 1
  minvalue 1
  maxvalue 10000
  nocache;  

-- 책갈피
drop table SCRAP cascade constraints;
CREATE TABLE SCRAP (
   Snum number   primary key, --책갈피 고유번호
   ID varchar2(100) references MEMBER(ID) on delete cascade, -- 회원아이디 
   Bnum number NOT NULL references BOARD(Bnum) on delete cascade -- 게시판번호
);

insert into scrap values(sseq.nextval,'hong',1);

select * from SCRAP;
commit;

drop sequence bcseq;
create sequence bcseq
  increment by 1
  start with 1
  minvalue 1
  maxvalue 10000
  nocache;  

-- 댓글
drop table BCOMMENT cascade constraints;
CREATE TABLE BCOMMENT (
   cnum number   primary key, --댓글 고유번호
   Bnum number references BOARD(Bnum) on delete cascade, -- 게시판 번호
   ID varchar2(100) references MEMBER(ID) on delete cascade, -- 회원아이디 
   cregdate date DEFAULT sysdate, --작성일
   cref   number   NOT NULL, --같은 댓글 그룹
   crestep   number   NOT NULL, --글의 순서(오래된건 후순위)
   crelevel   number   NOT NULL, --몇번째 글(댓글, 대댓글)
   Ccontent   varchar2(2000)   NOT NULL --내용
);

insert into BCOMMENT(cnum,Bnum,ID,cref,crestep,crelevel,Ccontent)
values(bcseq.nextval,1,'hong',1,0,0,'테스트 댓글');

select * from BCOMMENT;
commit;


-- 신고 테이블
drop table report cascade constraints;
CREATE TABLE Report (
   renum   number   primary key, --신고번호
   bcnum   number   NOT NULL, --댓글 or 게시판 번호
   ID varchar2(100) not null, -- 회원아이디 
   rtype varchar2(10) not null check(rtype in('board','bcomment')), --댓글인지 게시판인지
   status   varchar2(50)  NOT NULL, --신고 상태(게시글이나 댓글 삭제 시 처리 완료)
   rcontent   varchar2(1000)   NOT NULL -- 신고 내용
);

insert into report
values(reseq.nextval,1,'hong','bcomment','처리 준비','신고 테스트');

select * from Report;
commit;


-- 상품
drop sequence pseq;
create sequence pseq
  increment by 1
  start with 1
  minvalue 1
  maxvalue 10000
  nocache;
  
drop table product cascade constraints;
CREATE TABLE product (
   pnum   number   primary key, --상품번호
   ID varchar2(100) references MEMBER(ID) on delete cascade, -- 트레이너 아이디 
   price   number   NOT NULL, --상품 가격 (1이면 1만원이라는 뜻!) 
   months   number   NOT NULL, --회원권 사용기간
   pcount   number   NOT NULL, --회원권 사용갯수
   people   number   NOT NULL, --수업 참여 회원 갯수
   ptype   varchar2(15)   NOT NULL check(ptype in('개인', '그룹')), --개인, 그룹 수업 구분 "group"/"ind"
   ptime   number   NOT NULL --수업 시간길이 (1이면 1시간이라는 뜻!)
);


select * from product;
commit;


-- 주문
drop sequence oseq;
create sequence oseq
  increment by 1
  start with 1
  minvalue 1
  maxvalue 10000
  nocache;
  
drop table orders cascade constraints;
CREATE TABLE orders(
   onum   number   primary key, --주문번호
   ID   varchar2(100)   NOT NULL, --주문한 회원 아이디
   odate   date   NOT NULL --주문 날짜
);

select * from orders;
commit;


-- 주문내역
drop sequence odseq;
create sequence odseq
  increment by 1
  start with 1
  minvalue 1
  maxvalue 10000
  nocache;
  
drop table orderdetail cascade constraints;
CREATE TABLE orderdetail (
   odnum   number   primary key, --주문내역 번호
   pnum   number   NOT NULL, --상품 번호
   onum   number   NOT NULL --주문번호
);

select * from orderdetail;
commit;







-- PT사용권
drop sequence useq;
create sequence useq
  increment by 1
  start with 1
  minvalue 1
  maxvalue 10000
  nocache;
  
drop table usage cascade constraints;
CREATE TABLE usage (
   unum   number   primary key, --사용권번호
   pnum   number   NOT NULL, --상품번호
   onum   number   NOT NULL, --주문번호
   tid varchar2(100) references TRAINER(ID) on delete cascade, --트레이너 아이디
   mid varchar2(100) references MEMBER(ID) on delete cascade, -- 회원아이디 
   usage   number   NOT NULL --남은 횟수
);

select * from usage;
commit;


-- pt 예약
drop sequence reseq;
create sequence reseq
  increment by 1
  start with 1
  minvalue 1
  maxvalue 10000
  nocache;
  
drop table reservation cascade constraints;
CREATE TABLE reservation (
   rnum   number   primary key, --예약번호/시퀀스
   mid varchar2(100) references MEMBER(ID) on delete cascade, -- 회원아이디
   mname varchar2(100) references MEMBER(NAME) on delete cascade, -- 회원 이름
   tid varchar2(100) references TRAINER(ID) on delete cascade, --트레이너 아이디 
   onum   number   NOT NULL, --주문번호
   unum   number   NOT NULL,--사용권번호
   rdate varchar2(15) NOT NULL, --예약 날짜
   rtime varchar2(15) NOT NULL, --예약 시간 "00:00am"
   rstate varchar2(10) default 'false' --예약 상태 컬럼
);
select * from reservation;
commit;



-- 트레이너 스케줄
drop table tschedule cascade constraints;
CREATE TABLE tschedule (
   tid varchar2(100) references TRAINER(ID) on delete cascade, --트레이너 아이디
   tsday varchar2(30)   NOT NULL, --예약 가능 요일
   tstime varchar2(100)   NOT NULL,--예약 가능 시간
   tsdate varchar2(100) null --예약 불가능 날짜
);
select * from tschedule;
commit;








-- 회원별 운동정보
drop sequence hseq;
create sequence hseq
  increment by 1
  start with 1
  minvalue 1
  nocache;

drop table healthdate cascade constraints;
CREATE TABLE healthdate (
   hnum   number   primary key, -- 운동정보 번호
   ID varchar2(100) references MEMBER(ID) on delete cascade, -- 회원아이디 
   hdate   date   NOT NULL, --운동일자
   tid varchar2(100) default 'notrainer' --담당 트레이너 아이디 트레이너 정보가 없을 시 notrainer 삽입
);

insert into healthdate values(hseq.nextval, 'hong', '2023-06-01','kim');
insert into healthdate values(hseq.nextval, 'hong', '2023-06-02','kim');
insert into healthdate values(hseq.nextval, 'hong', '2023-06-01','lee');
insert into healthdate values(hseq.nextval, 'hong', '2023-06-03','lee');
insert into healthdate values(hseq.nextval, 'hong', '2023-06-05','notrainer');

select * from healthdate;
commit;


drop table health cascade constraints;
CREATE TABLE health (
   hnum number references healthdate(hnum) on delete cascade, --운동정보 번호
   hname   varchar2(30)   NOT NULL, --운동명
   starttime   timestamp, --시작시간
   endtime   timestamp, --종료시간
   hcount number default 0, --횟수 --세트
   hset number default 0
);

insert into health values(1, '유산소','2023-06-01 11:00','2023-06-01 11:30',0,0);
insert into health values(1, '벤치프레스','2023-06-01 11:30','2023-06-01 11:40',10,3);
insert into health values(2, '유산소','2023-06-02 11:00','2023-06-02 11:30',0,0);
insert into health values(2, '스쿼트','2023-06-02 11:30','2023-06-02 12:00',12,5);
insert into health values(3, '캐딜락','2023-06-01 16:30','2023-06-01 17:00',17,3);
insert into health values(3, '리포머','2023-06-01 17:20','2023-06-01 17:50',15,3);
insert into health values(4, '래더바렐','2023-06-03 15:30','2023-06-03 16:00',12,5);
insert into health values(4, '스프링보드','2023-06-03 16:30','2023-06-03 17:00',19,5);
insert into health values(4, '캐딜락','2023-06-03 17:00','2023-06-03 17:20',20,5);
insert into health values(5, '스쿼트','2023-06-03 17:00','2023-06-03 17:20',20,5);


select * from health;
commit;


-- 회원별 식단 정보
drop sequence nseq;
create sequence nseq
  increment by 1
  start with 1
  minvalue 1
  nocache;
  
drop table nutrition cascade constraints;
CREATE TABLE nutrition (
   nnum   number   primary key, --식단번호
   ID varchar2(100) references MEMBER(ID) on delete cascade, -- 회원아이디 
   fnum   number   NOT NULL, --음식번호
   mealtype   VARCHAR(10), -- 아침 점심 저녁 기타
   nutritiondate   date --식사일자
);

select * from nutrition;
commit;


-- 음식정보
drop sequence fseq;
create sequence fseq
  increment by 1
  start with 1
  minvalue 1
  nocache;
  
drop table food cascade constraints;
CREATE TABLE food (
   fnum   number primary key, --음식번호
   fname   varchar2(50), --음식이름
   fweight number default 0.0, -- 음식무게
   calories   number, --칼로리
   carbohydrate   number, --탄수화물
   protein   number, --단백질
   fat   number, --지방
   saturatedfat   number, --포화지방
   sodium   number --나트륨
);

select * from food;
commit;


-- 신체정보
drop sequence phseq;
create sequence phseq
  increment by 1
  start with 1
  minvalue 1
  nocache;
  
drop table physique cascade constraints;
CREATE TABLE physique (
   phnum   number   primary key, --신체번호
   ID   varchar2(100)   NOT NULL, --아이디
   height   number default 0.0, --신장(cm) 
   weight   number default 0.0, --체중(kg)
   BMI   number default 0.0, --bmi
   phdate   date, --측정일
   skeletalmuscle   number default 0.0, --골격근량(kg)
   bodyfatper   number default 0.0, --체지방률(%)
   bmr   int, --기초대사량(kcal)
   phimage varchar2(300) -- 인바디 이미지
);

insert into physique values(phseq.nextval, 'hong', 170.5, 90.0, 30.9, '2023-04-30', 29.3, 33.2, 1607, null);
insert into physique values(phseq.nextval, 'hong', 170.5, 85.0, 29.2, '2023-05-10', 30.3, 30.5, 1570, 'hong_inbody1.jpg');
insert into physique values(phseq.nextval, 'hong', 170.5, 80.1, 27.5, '2023-05-23', 31.5, 29.8, 1540, 'hong_inbody2.jpg');
insert into physique values(phseq.nextval, 'hong', 170.5, 75.4, 25.9, '2023-06-01', 32.9, 28.1, 1580, 'hong_inbody3.jpg');
insert into physique values(phseq.nextval, 'hong', 170.5, 70.0, 24.07, '2023-06-07', 33.1, 27.5, 1607, 'hong_inbody4.jpg');

select * from physique;
commit;

--문의 테이블
drop sequence qseq;
create sequence qseq
  increment by 1
  start with 1
  minvalue 1
  maxvalue 10000
  nocache;
  
drop table question cascade constraints;
CREATE TABLE question (
   qnum   number   primary key, --문의 번호
   ID varchar2(100) references MEMBER(ID) on delete cascade, -- 회원아이디 
   qdate   date   NOT NULL, --문의 날짜 
   qcontent   varchar2(500)   NOT NULL, --문의 내용
   qsubject   varchar2(60)   NOT NULL, --문의 제목
   qstatus   varchar2(20)  NOT NULL check(qstatus in('답변완료', '답변미완료'))--문의 답변 상태 "answered" / "unanswered"
);

select * from question;
commit;


--문의 답변
drop sequence qcseq;
create sequence qcseq
  increment by 1
  start with 1
  minvalue 1
  maxvalue 10000
  nocache;
  
drop table QComment cascade constraints;
CREATE TABLE QComment (
   qcnum   number primary key,
   qnum   number   NOT NULL,
   qcomment   varchar2(500),
   qcdate   date
);

select * from QComment;
commit;



--리뷰 테이블
drop sequence rvseq;
create sequence rvseq
  increment by 1
  start with 1
  minvalue 1
  maxvalue 10000
  nocache;
  
drop table review cascade constraints;
CREATE TABLE review (
	renum number primary key,
	mid varchar2(100),
	tid varchar2(100),
	rating number check(rating between 0 and 5),
	rtitle varchar2(100),
	rcontent varchar2(500),
	rdate date default sysdate,
	hasReview varchar2(10) check(hasReview in('Y', 'N')),
	report varchar2(10) check(report in('Y', 'N'))
);
select * from review;
commit;